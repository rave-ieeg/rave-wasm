<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redirecting...</title>
  <script>
    // GitHub Pages serves this 404.html for non-existent paths.
    // Shinylive creates virtual paths like /repo/app-name/app_xxx/ that are
    // handled by the service worker, but GitHub doesn't know about them.
    // This script redirects back to the app's index.html so the service
    // worker can properly intercept the request.
    
    (function() {
      var path = window.location.pathname;
      
      // Match paths like: /repo/app-name/app_xxx/...
      // The app_xxx pattern is generated by shinylive for virtual app routes
      var appPathMatch = path.match(/^(.*\/[^\/]+)\/app_[^\/]+\//);
      
      if (appPathMatch) {
        // Redirect to the parent app's index.html
        // e.g., /rave-wasm/freesurfer-viewer/app_xxx/ -> /rave-wasm/freesurfer-viewer/index.html
        var appBasePath = appPathMatch[1];
        var targetUrl = appBasePath + '/index.html' + window.location.search + window.location.hash;
        
        // Use replace to avoid adding to browser history
        window.location.replace(targetUrl);
      } else {
        // For other 404s, show a simple message
        document.body.innerHTML = '<h1>Page Not Found</h1><p>The requested page could not be found.</p><p><a href="/">Return to Home</a></p>';
      }
    })();
  </script>
</head>
<body>
  <noscript>
    <h1>Page Not Found</h1>
    <p>JavaScript is required to load this application.</p>
  </noscript>
</body>
</html>
